## 可用性
> 一个系统要想拥有高可用性，有且只有一个办法 -- 副本replication

### 主从Master-Slave
- standby 一个新副本。只有当原来的副本出现故障的时候，才failover到新副本提供服务。
- 如HDFS的NameNode、Yarn的Resource Manager

#### 为什么有些地方不采用standby？
1. failover 的生效是需要过程的，哪怕只有几秒，这期间的响应都会被阻塞或丢弃在客户端。
2. 既然都为了可用性花了额外的钱了，为什么不让副本也发挥点作用呢，比如提供读操作来缓解下系统的性能压力。

#### 多主副本
- 每个副本都可以对外提供服务。
- 但是会带来一致性问题。

#### 去中心化
- 客户端不再只请求leader，可以同时请求写 3 个节点，相当于在客户端实现了主动的数据复制功能。
- 读数据时不确定哪个节点的数据是最新的，也需要像写数据那样同时请求多个节点。

### 副本的有效性
- 同步复制：保证数据复制到所有副本之后，再返回 OK 给客户端
    - 其中的副本异常，就会阻塞其他的请求。
- 异步复制：leadre 接受到数据后，立刻返回 OK 给客户端，并继续处理其他客户端请求，而数据复制就交给另外的线程异步去处理。
    - leader 如果还没来得及同步数据给 follower 就宕机了，就有丢失数据的可能。
- 半同步复制：只有 3 个副本的情况下，leader 接收到客户端数据后，立刻落地到本地，同时以同步的方式复制给 follower 中的一个，然后返回 OK 给客户端，剩下的一个 follower 就以异步的方式复制数据。




