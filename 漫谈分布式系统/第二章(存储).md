## 分布式存储

### 操作系统的文件存储
##### 文件存储
1. 文件存储在硬盘上
2. 文件存取最小单位是块block，由扇区组成，最常见的块大小为4KB，即8个连续的sector组成一个block
3. 硬盘的最小存储单位叫做扇区sector，每个扇区存储512字节
4. 一次读取一个block的数据

##### 索引文件系统中inode的存储方式：
- 每个inode节点的大小，一般是128字节或256字节。
- inode节点的总数，在格式化时就给定，一般是每1KB或每2KB就设置一个inode。
- 假定在一块1GB的硬盘中，每个inode节点的大小为128字节，每1KB就设置一个inode，那么inode table的大小就会达到128MB，占整块硬盘的12.8%。
- **所以可能会出现磁盘还有空间但无法新建文件，因为该硬盘上的inode节点用完了。**

### 海量数据成本
- 删除无用数据
- 减少副本数(hadoop3使用Erasure Coding编码)
- 压缩文件
    - 压缩/解压速度和压缩比的平衡。
        - 典型的效果和效率的 trade-off，所以很多场景下会选择 snappy 这种比较平衡的压缩算法。
    - splittable，也就是可切分。
        - 在 MapReduce 这样的计算模型下，如果一个文件过大又不可切分，那就只能被一个任务处理，而没法分配给多个任务并行处理，自然会拖慢整体性能。
    - 文件格式的选择。
        - 最常见的 TextFile 其实效率不好，而类似 Avro、ORC 和 Parquet 的列式存储格式通常会有更好的效率。
- 分层存储
    - 访问多和访问性能要求高的数据，就放在热存储上，通常数据量级比较小。
    - 访问少和访问性能要求低的数据，就放在冷存储上，通常数据量级比较大。

